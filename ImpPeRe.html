<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Imperial Penal Report</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="ImpPeRe.js"></script>
	<script src="locations.js"></script>
	<script src="regions.js"></script>
	<script src="events.js"></script>
	<script src="hyperspace.js"></script>
	<link rel="stylesheet" href="ImpPeRe.css">
</head>

<body id='body'>

	<h2 id="mainHeader" class="fontStarWars">Imperial Penal Report</h2>
	<button onclick="switchFontBesh()" class="fontBesh tooltip">
		Aurebesh
		<span class="tooltiptext">
		Switch to Aurebesh font.
		</span>
	</button>
	<button onclick="switchFontStarWars()" class="fontStarWars tooltip">
		Galactic Basic
		<span class="tooltiptext">
		Switch to Star Wars font.
		</span>
	</button>
	<button onclick="switchFontNormal()" class="fontNormal tooltip">
		En'glsh
		<span class="tooltiptext">
		Switch to normal font.
		</span>
	</button>

	<table border="2" width="100%">
		<tr>
			<td class="widthHalf margin0">
				<label for="locationDropdown" id="locationDropdownLabel" class="fontStarWars">Location:
					<select id="locationDropdown">
						<option value="">-- Current Location --</option>
					</select>
				</label><br/>
				<a id="currentURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">https://starwars.fandom.com/wiki/Planet/Legends</a>
			</td>
			<td class="widthHalf margin0">
				<label for="destinationDropdown" id="destinationDropdownLabel" class="fontBesh">Destination:
					<select id="destinationDropdown">
						<option value="">-- Select Destination --</option>
					</select>
				</label><br/>
				<a id="destURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">https://starwars.fandom.com/wiki/Planet/Legends</a>
			</td>
		</tr>
		<tr>
			<td class="alignTop widthHalf margin0 colSpan2">
				<div id="locationDetails" class="section tooltip widthHalf">
					<span class="tooltiptext">
					Known and reported details of your current location.
					</span>
					<h3>BoSS Database</h3>
					<ul class="locationDetailsList">
						<li class="locationDetailsItem">
							<strong>Region:</strong> <a id="currentRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="currentRegion">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Sector:</strong> <span id="currentSector">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>System:</strong> <span id="currentSystem">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Capital City:</strong> <span id="currentCapital">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Starport:</strong> <a href="https://starwars.fandom.com/wiki/Spaceport/Legends"><span id="currentStarport">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Map:</strong> <span id="currentMap">unknown</span><br/>
						</li>
						<li class="locationDetailsItem">
							<strong>Hyperspace Lanes:</strong> <pre id="currentHyperspaceLanes">unknown</pre>
						</li>
					</ul>
					<h3>Atmosphere & Terrain</h3>
					<ul class="locationDetailsList">
						<li class="locationDetailsItem">
							<label for="currentAtmosphere" id="currentAtmosphereLabel">
								Atmosphere: <span id="currentAtmosphere">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="currentAtmosphere" id="currentAtmosphereLabel">
								Terrain: <span id="currentAtmosphere">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="currentClimate" id="currentClimateLabel">
								Climate: <span id="currentClimate">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="currentGravity" id="currentGravityLabel">
								Gravity: <span id="currentGravity">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="currentInhabitants" id="currentInhabitantsLabel">
								Inhabitants: <span id="currentInhabitants">unknown</span>
							</label>
						</li>
					</ul>
<!--
					<h3>Current Conditions</h3>
					<p>
						<strong>Climate:</strong> unknown
						<strong>Weather:</strong> unknown
						<strong>Terrain:</strong> unknown
					</p>
-->
				</div>
			</td>
			<td class="alignTop widthHalf margin0 colSpan2">
				<div id="destinationDetails" class="section tooltip widthHalf">
					<span class="tooltiptext">
					Known and reported details of your Destination.
					</span>
					<h3>BoSS Database</h3>
					<ul class="locationDetailsList">
						<li class="locationDetailsItem">
							<strong>Region:</strong> <a id="destRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="destRegion">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Sector:</strong> <span id="destSector">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>System:</strong> <span id="destSystem">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Capital City:</strong> <span id="destCapital">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Starport:</strong> <a href="https://starwars.fandom.com/wiki/Spaceport/Legends"><span id="destStarport">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Map:</strong> <span id="destMap">unknown</span><br/>
						</li>
						<li class="locationDetailsItem">
							<strong>Hyperspace Lanes:</strong> <pre id="destHyperspaceLanes">unknown</pre>
						</li>
					</ul>
					<h3>Atmosphere & Terrain</h3>
					<ul class="locationDetailsList">
						<li class="locationDetailsItem">
							<label for="destAtmosphere" id="destAtmosphereLabel">
								Atmosphere: <span id="destAtmosphere">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="destAtmosphere" id="destAtmosphereLabel">
								Terrain: <span id="destAtmosphere">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="destClimate" id="destClimateLabel">
								Climate: <span id="destClimate">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="destGravity" id="destGravityLabel">
								Gravity: <span id="destGravity">unknown</span>
							</label>
						</li>
						<li class="locationDetailsItem">
							<label for="destInhabitants" id="destInhabitantsLabel">
								Inhabitants: <span id="destInhabitants">unknown</span>
							</label>
						</li>
					</ul>
					<h3>Hyperspace Travel</h3>
					<strong>Estimated Travel Time</strong> (hyperroute factor <span id="hyperrouteFactor">1.0</span>, Class <span id="ettHyperdriveClass">?</span>): <span id="estHyperspaceTime">calculating...</span><br/>
					reference (<span id="baseHyperSpaceDistance"></span>no hyperroutes, Class 1): <span id="baseHyperspaceTime">calculating...</span><br/>
				</div>
			</td>
		</tr>
	</table>
	<table border="2" width="100%">
		<tr><!-- Ship, Crew, and Conditions options -->
			<td>
				<p>
					<div class="nowrap tooltip">
						<ul>
							<li class="manifestItem">
								<h2 style="margin-right: 50px;">Ship Manifest</h2>
							</li>
							<li class="manifestItem">
								<label for="silh" id="silhLabel">
									Silhouette: <input type="number" id="silh" max="10" maxlength="2" min="0" defaultValue="4"><span id="silh5plus"></span></input>
								</label>
							</li>
							<li class="manifestItem">
								<label for="hyperdrive">
									Hyperdrive: Class <input type="number" id="hyperdrive" max="20" maxlength="2" min="1" defaultValue="15"></input>
								</label>
							<li class="manifestItem">
								<label for="cargo">Cargo Declared: <input type="number" id="cargo" min="0" defaultValue="0"></input>cr</label>
							</li>
							</li>
						</ul>
						<span class="tooltiptext">
						CAPTAIN, you must declare your ship's status, logs, and cargo in order to retrieve Hyperspace Lane updates and BoSS certification.
						</span>
					</div>
				</p>
			</td>
		</tr>
	</table>

	<table border="2" width="100%">
		<tr><!-- Imperial Presence -->
			<td class="alignMiddle">
				<div class="localCustomsBox tooltip">
					<span class="tooltiptext">
					Last reported starport fees for this location. Consult your Game Master.
					</span>
					<h3 class="localCustomsBoxHeader">Starport <span id="starportHeader"></span></h3>
					<strong>Landing Fee:</strong> <span id="textFeePortLanding"></span><br/>
					<strong>Berthing Fee (per day):</strong> <span id="textFeePortBerthing"></span><br/>
					<strong>Customs Fee:</strong> <span id="textFeeCustoms"></span><br/>
					<strong>Visitation Fee:</strong> <span id="textFeeVisitation"></span><br/>
					<strong>Departure Wait:</strong> <span id="textWaitDeparture"></span><br/>
					<center><strong>Smuggling Penalty: Confiscation + 20% contraband value</span></center>
				</div>
				<div class="localCustomsBox tooltip">
					<span class="tooltiptext">
					Last reported local restrictions on weapons and armor at this location. Consult your Game Master.
					</span>
					<h3 class="localCustomsBoxHeader">Weapon Permits</h3>
					<strong>Concealed:</strong> <span id="textPermitWeaponConcealed"></span><br/>
					<strong>Small Arms:</strong> <span id="textPermitWeaponSmall"></span><br/>
					<strong>Rifles, Large Melee:</strong> <span id="textPermitWeaponRifle"></span><br/>
					<strong>Heavy Weapons:</strong> <span id="textPermitWeaponHeavy"></span><br/>
					<strong>Light Armor:</strong> <span id="textPermitArmorLight"></span><br/>
					<strong>Power Armor:</strong> <span id="textPermitArmorPower"></span><br/>
					<center><strong>Violations: Confiscation + 200% of permit fee</strong><br/></center>
				</div>
				<div class="localCustomsBox tooltip">
					<span class="tooltiptext">
					Last reported local laws for this location. Consult your Game Master.
					</span>
					<h3 class="localCustomsBoxHeader">Contraband</h3>
					<strong>Spice:</strong> <span id="textLawSpice"></span><br/>
					<strong>Trespassing:</strong> <span id="textLawTrespassing"></span><br/>
					<strong>Military Gear:</strong> <span id="textLawMilitary"></span><br/>
					<strong>Slicing:</strong> <span id="textLawSlicing"></span><br/>
					<strong>Criticism of the Empire:</strong> <span id="textLawCriticism"></span><br/>
					<strong>Slavery:</strong> <span id="textLawSlavery"></span><br/>
					<strong>Minor Theft:</strong> <span id="textLawTheft"></span><br/>
					<strong>Bribery:</strong> <span id="textLawBribery"></span>
				</div>
			</td>
			<td class="localEvents">
				<h4 class="localCustomsBoxHeader fontStarWars">Local Events reported at <span id="localEventsLocation">your location</span></h4>
				<div class="tooltip">
					<span class="tooltiptext">
					See the Suggested Usage below. These are all SUGGESTIONS to enhance the story. Nothing is required.
					</span>
					<ul id="localEvents" class="fontNormal">
						<center>(select a Location at top left)</center>
					</ul><!-- populated dynamically -->
				</div>
				<div id="instructionsBox" class="instructionsBox fontStarWars tooltip"><strong>Suggested Usage:</strong>
					<span class="tooltiptext">
					First step is to choose a Location (not Destination) from the dropdown at top left.<br/>
					This populates the details for that location and some random local events which can be optionally chosen.<br/>
					Next, choose a Destination at top right to show details for that location and estimated travel statistics.<br/>
					If you can't read the font, there are buttons underneath the main header. If they don't work, you may have disabled JavaScript.<br/>
					</span>
					<ul>
						<li><em>Select a Location</em> (top left) to retrieve local events and customs from BoSS, regional governors, HoloNet, etc.</li>
						<li>Each local event is a <i>possibility</i>, a <i>rumor</i>, to enhance the narrative. <b>Nothing is required.</b> Use what makes sense and prompts a better story.</li>
						<li>During their stay in the system, each PC may, at any time, choose to select <em>up to one local event</em> to <em>activate</em> or <em>negate</em> the event for the duration of their stay.</li>
						<li>A local event, once chosen, is unavailable for further actions.</li>
						<li><span class="localEventFree">Free Events</span> may be activated or negated for the duration of stay <i>at no cost</i>, limited to one per player.</li>
						<li><span class="localEventDestinyRequired">Destiny Required Events</span> always require a Destiny Point to activate or negate.</li>
						<li><span class="localEventDestinyOptional">Destiny Optional Events</span> can apply for one transaction only at no cost, or a Destiny Point may be used to create a permanent NPC.</li>
						<li><span class="localEventDestinyOptional">Destiny Optional Event</span>-created permanent NPCs are named and managed by the PC who created them, voiced by the GM, and are always available at this location and able to perform the chosen service at no future cost by any PC.</li>
						<li>The GM may, at their discretion, not allow NPCs or events to be found in locations where it doesn't make sense.</li>
						<li>Upon system arrival, and after the party has chosen whether to select any events initially, the GM may spend a Destiny Point on up to one <span class="localEventDestinyRequired">Destiny Required Event</span> to activate or negate, and as many <span class="localEventFree">Free Events</span> as creates a good story.</li>
						<li>Expect Imperial presence to be higher near the Core, and weapons laws to be looser nearer or past the Outer Rim.</li>
						<li>Capital Ships (silhouette 5+) pay substantially higher Starport costs.</li>
						<li>Upon departure, all local events and NPCs not made permanent via Destiny Points are reset.</li>
						<li><em>Select a Destination</em> (top right) to display details and estimated travel statistics to that system. Hyperdrive class impacts this heavily, as does the number and quality of Hyperspace Lanes available at this location.</li>
					</ul>
				</div>
			</td>
		</tr>
	</table>

	<script>

		function updateSilhouette()
		{
			shipSilh = $('#silh').val();

			if (shipSilh > 4) // Commercial/Military size
			{
				$('#silhLabel').addClass("silhouette5plus");
			}
			else
			{
				$('#silhLabel').removeClass("silhouette5plus");
			}

			updateLocalCustoms();
		}

		$(document).ready(function () {
			switchFontBesh(); // set initial font

			// minimize collapsible sections
			$("#locationDetails").slideUp();
			$("#destinationDetails").slideUp();

			// Default input values
			$('#cargo').val(0);
			$('#silh').val(4);
			$('#hyperdrive').val(15);

			// Populate location dropdown
			const $locationDropdown = $("#locationDropdown");
			$.each(locations, function (index, location) {
				$locationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Populate destination dropdown
			const $destinationDropdown = $("#destinationDropdown");
			$.each(locations, function (index, location) {
				$destinationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Location dropdown events
			$("#locationDropdown").on("change", function () {
				$("#locationDetails").slideDown(); // display current location details
				switchFontNormal(); // reset font-family

				const currentLocation = $("#locationDropdown").val();
				currentLoc = locations.find(item => item.Name === currentLocation); // JSON object
				currentRegion = regions.find(region => region.Name === currentLoc.Region); // JSON object
				$('#localEventsLocation').text(currentLocation);

				updateCurrentDetails();

				updateLocalCustoms();

				updateTravelEstimates();

				updateLocalEvents();
			});

			// Destination dropdown events
			$("#destinationDropdown").on("change", function () {
				$("#destinationDetails").slideDown();
				switchFontNormal(); // reset font-family

				currentDestination = $("#destinationDropdown").val();
				destLoc = locations.find(item => item.Name === currentDestination); // JSON object
				destRegion = regions.find(region => region.Name === destLoc.Region); // JSON object

				updateDestDetails();

				updateTravelEstimates();

				updateDestDetails();
			});

			// On Change event for Ship Silhouette
			document.getElementById('silh').addEventListener("change", updateSilhouette);

			// On Change event for Hyperdrive Class
			document.getElementById('hyperdrive').addEventListener("change", updateTravelEstimates);
		});
	</script>

</body>

</html>
