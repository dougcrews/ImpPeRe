<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Imperial Penal Report</title>
	<link rel="icon" type="image/x-icon" href="favicon.png">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="ImpPeRe.js"></script>
	<script src="locations.js"></script>
	<script src="regions.js"></script>
	<script src="events.js"></script>
	<script src="hyperspace.js"></script>
	<link rel="stylesheet" href="ImpPeRe.css">
</head>

<body id='body'>

	<h2 id="mainHeader" class="font-starwars">Imperial Penal Report</h2>
	<button onclick="switchFontBesh()" class="font-besh tooltip">
		Aurebesh
		<span class="tooltiptext">
		Switch to Aurebesh font.
		</span>
	</button>
	<button onclick="switchFontStarWars()" class="font-starwars tooltip">
		Galactic Basic
		<span class="tooltiptext">
		Switch to Star Wars font.
		</span>
	</button>
	<button onclick="switchFontNormal()" class="font-normal tooltip">
		En'glsh
		<span class="tooltiptext">
		Switch to normal font.
		</span>
	</button>

	<table border="2" width="100%">
		<tr>
			<td class="width-half margin-0">
				<label for="locationDropdown" id="locationDropdownLabel" class="font-starwars">Location:
					<select id="locationDropdown">
						<option value="">-- Current Location --</option>
					</select>
				</label>
				<div class="flex-container secret-filters hidden manifest-menu-hidden"><!-- display if Pirate Holonet or similar is installed -->
					<em>Filters: </em>&nbsp;&nbsp;&nbsp;
					<label for="filterCurrBlackMarket">
						Black Market: <input type="checkbox" id="filterCurrBlackMarket" class="filter-input-hidden"></input>
					</label>&nbsp;&nbsp;
					<label for="filterCurrShadowport">
						Shadowport: <input type="checkbox" id="filterCurrShadowport" class="filter-input-hidden"></input>
					</label>&nbsp;&nbsp;
					<label for="filterCurrStarportGrade">
						Starport Grade: <input type="number" id="filterCurrStarportGrade" class="filter-input-hidden" min="0" max="5" defaultValue="0"></input>&nbsp;&nbsp;
					</label>
				</div>
				<a id="currentURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">https://starwars.fandom.com/wiki/Planet/Legends</a>
			</td>
			<td class="width-half margin-0">
				<label for="destinationDropdown" id="destinationDropdownLabel" class="font-besh">Destination:
					<select id="destinationDropdown">
						<option value="">-- Select Destination --</option>
					</select>
				</label>
				<div class="flex-container secret-filters hidden manifest-menu-hidden"><!-- display if Pirate Holonet or similar is installed -->
					<em>Filters: </em>&nbsp;&nbsp;&nbsp;
					<label for="filterDestBlackMarket">
						Black Market: <input type="checkbox" id="filterDestBlackMarket" class="filter-input-hidden"></input>
					</label>&nbsp;&nbsp;
					<label for="filterDestShadowport">
						Shadowport: <input type="checkbox" id="filterDestShadowport" class="filter-input-hidden"></input>
					</label>&nbsp;&nbsp;
					<label for="filterDestStarportGrade">
						Starport grade: <input type="number" id="filterDestStarportGrade" class="filter-input-hidden" min="0" max="5" defaultValue="0"></input>&nbsp;&nbsp;
					</label>
				</div>
				<a id="destURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">https://starwars.fandom.com/wiki/Planet/Legends</a>
			</td>
		</tr>
		<tr>
			<td class="align-top width-half margin-0 colspan-2">
				<div id="locationDetails" class="section tooltip width-half">
					<span class="tooltiptext">
					Known and reported details of your current location.
					</span>
					<h3>BoSS Database</h3>
					<div class="flex-container">
						<div class="box-around">
							<strong>Region:</strong> <a id="currentRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="currentRegion">unknown</span></a>
						</div>
						<div class="box-around">
							<strong>Sector:</strong> <span id="currentSector">unknown</span>
						</div>
						<div class="box-around">
							<strong>System:</strong> <span id="currentSystem">unknown</span>
						</div>
						<div class="box-around">
							<strong>Capital City:</strong> <span id="currentCapital">unknown</span>
						</div>
						<div class="box-around">
							<strong>Starport:</strong> <a href="https://starwars.fandom.com/wiki/Spaceport/Legends"><span id="currentStarport">unknown</span></a>
						</div>
						<div class="box-around">
							<strong>Map:</strong> <span id="currentMap">unknown</span>
						</div>
					</div>
					<div class="flex-container">
						<div class="box-around">
							<strong>Hyperlanes:</strong> <pre id="currentHyperlanes">unknown</pre>
						</div>
					</div>
					<h3>Atmosphere & Terrain</h3>
					<div class="flex-container">
						<div class="box-around">
							<strong>Atmosphere:</strong> <span id="currentAtmosphere">unknown</span>
						</div>
						<div class="box-around">
							<strong>Terrain:</strong> <span id="currentTerrain">unknown</span>
						</div>
						<div class="box-around">
							<strong>Climate:</strong> <span id="currentClimate">unknown</span>
						</div>
						<div class="box-around">
							<strong>Gravity:</strong> <span id="currentGravity">unknown</span>
						</div>
						<div class="box-around">
							<strong>Inhabitants:</strong> <span id="currentInhabitants">unknown</span>
						</div>
<!--
					<br/>
					<h3>Current Conditions</h3>
					<strong>Climate:</strong> unknown
					<strong>Weather:</strong> unknown
					<strong>Terrain:</strong> unknown
-->
					</div>
				</div>
			</td>
			<td class="align-top width-half margin-0 colspan-2">
				<div id="destinationDetails" class="section tooltip width-half">
					<span class="tooltiptext">
					Known and reported details of your Destination.
					</span>
					<h3>BoSS Database</h3>
					<div class="flex-container">
						<div class="box-around">
							<strong>Region:</strong> <a id="destRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="destRegion">unknown</span></a>
						</div>
						<div class="box-around">
							<strong>Sector:</strong> <span id="destSector">unknown</span>
						</div>
						<div class="box-around">
							<strong>System:</strong> <span id="destSystem">unknown</span>
						</div>
						<div class="box-around">
							<strong>Capital City:</strong> <span id="destCapital">unknown</span>
						</div>
						<div class="box-around">
							<strong>Starport:</strong> <a href="https://starwars.fandom.com/wiki/Spaceport/Legends"><span id="destStarport">unknown</span></a>
						</div>
						<div class="box-around">
							<strong>Map:</strong> <span id="destMap">unknown</span>
						</div>
					</div>
					<div class="flex-container">
						<div class="box-around">
							<strong>Hyperlanes:</strong> <pre id="destHyperlanes">unknown</pre>
						</div>
					</div>
					<h3>Atmosphere & Terrain</h3>
					<div class="flex-container">
						<div class="box-around">
							<strong>Atmosphere:</strong> <span id="destAtmosphere">unknown</span>
						</div>
						<div class="box-around">
							<strong>Terrain:</strong> <span id="destTerrain">unknown</span>
						</div>
						<div class="box-around">
							<strong>Climate:</strong> <span id="destClimate">unknown</span>
						</div>
						<div class="box-around">
							<strong>Gravity:</strong> <span id="destGravity">unknown</span>
						</div>
						<div class="box-around">
							<strong>Inhabitants:</strong> <span id="destInhabitants">unknown</span>
						</div>
					</div>
					<h3>Hyperlane Travel</h3>
					<div class="flex-container">
						<div class="box-around">
							<div>
								<strong>Estimated Travel Time</strong> (factor <span id="hyperrouteFactor">1.0</span>, Class <span id="ettHyperdriveClass">?</span>): <span id="estHyperspaceTime">calculating...</span><br/>
							</div>
							<div class="reference-note">
								[ reference (<span id="baseHyperSpaceDistance"></span>factor 1.0, Class 1): <span id="baseHyperspaceTime">calculating...</span> ]
							</div>
						</div>
					</div>
				</div>
			</td>
		</tr>
	</table>
	<table border="2" width="100%">
		<tr><!-- Ship, Crew, and Conditions options -->
			<td>
				<p>
					<div class="tooltip">
						<span class="ship-manifest-header">
							Ship Manifest
						</span>
						<ul class="ship-manifest-menu">
							<li class="ship-manifest-item">
								<label for="silh" id="silhLabel">
									Silhouette: <input type="number" id="silh" max="10" maxlength="2" min="0" defaultValue="4"><span id="silh5plus"></span></input>
								</label>
							</li>
							<li class="ship-manifest-item">
								<label for="hyperdrive">
									Hyperdrive: Class <input type="number" id="hyperdrive" max="20" maxlength="2" min="1" defaultValue="15"></input>
								</label>
							</li>
							<li class="ship-manifest-item">
								<label for="cargo">Cargo Declared: <input type="number" id="cargo" min="0" defaultValue="0"></input>cr</label>
							</li>
							<li class="ship-manifest-item secret-manifest-item">
								<label for="pirateHolonet">Pirate HoloNet: <input type="checkbox" id="pirateHolonet"></input></label>
							</li>
						</ul>
						<span class="tooltiptext">
						CAPTAIN, you must declare your ship's status, logs, and cargo in order to retrieve Hyperlane updates and BoSS certification.
						</span>
					</div>
				</p>
			</td>
		</tr>
	</table>

	<table border="2" width="100%">
		<tr><!-- Imperial Presence -->
			<td class="align-top">
				<div class="local-customs-box tooltip">
					<span class="tooltiptext">
					Last reported starport fees for this location. Consult your Game Master.
					</span>
					<h3 class="local-customs-box-header">Starport <span id="starportHeader"></span></h3>
					<strong>Landing Fee:</strong> <span id="textFeePortLanding" class="smaller"></span><br/>
					<strong>Berthing Fee (per day):</strong> <span id="textFeePortBerthing" class="smaller"></span><br/>
					<strong>Customs Fee:</strong> <span id="textFeeCustoms" class="smaller"></span><br/>
					<strong>Visitation Fee:</strong> <span id="textFeeVisitation" class="smaller"></span><br/>
					<strong>Departure Wait:</strong> <span id="textWaitDeparture" class="smaller"></span><br/>
					<center><strong>Smuggling Penalty: Confiscation + 20% contraband value</span></center>
				</div>
				<div class="local-customs-box tooltip">
					<span class="tooltiptext">
					Last reported local restrictions on weapons and armor at this location. Consult your Game Master.
					</span>
					<h3 class="local-customs-box-header">Weapon Permits</h3>
					<strong>Concealed:</strong> <span id="textPermitWeaponConcealed" class="smaller"></span><br/>
					<strong>Small Arms:</strong> <span id="textPermitWeaponSmall" class="smaller"></span><br/>
					<strong>Rifles, Large Melee:</strong> <span id="textPermitWeaponRifle" class="smaller"></span><br/>
					<strong>Heavy Weapons:</strong> <span id="textPermitWeaponHeavy" class="smaller"></span><br/>
					<strong>Light Armor:</strong> <span id="textPermitArmorLight" class="smaller"></span><br/>
					<strong>Power Armor:</strong> <span id="textPermitArmorPower" class="smaller"></span><br/>
					<center><strong>Violations: Confiscation + 200% of permit fee</strong><br/></center>
				</div>
				<div class="local-customs-box tooltip">
					<span class="tooltiptext">
					Last reported local laws for this location. Consult your Game Master.
					</span>
					<h3 class="local-customs-box-header">Contraband</h3>
					<strong>Spice:</strong> <span id="textLawSpice" class="smaller"></span><br/>
					<strong>Trespassing:</strong> <span id="textLawTrespassing" class="smaller"></span><br/>
					<strong>Military Gear:</strong> <span id="textLawMilitary" class="smaller"></span><br/>
					<strong>Slicing:</strong> <span id="textLawSlicing" class="smaller"></span><br/>
					<strong>Criticism of the Empire:</strong> <span id="textLawCriticism" class="smaller"></span><br/>
					<strong>Slavery:</strong> <span id="textLawSlavery" class="smaller"></span><br/>
					<strong>Minor Theft:</strong> <span id="textLawTheft" class="smaller"></span><br/>
					<strong>Bribery:</strong> <span id="textLawBribery" class="smaller"></span>
				</div>
			</td>
			<td class="local-events align-top">
				<h4 class="local-customs-box-header font-starwars">Local Events reported at <span id="local-eventsLocation">your location</span></h4>
				<div class="tooltip">
					<span class="tooltiptext">
					See the Suggested Usage below. These are all SUGGESTIONS to enhance the story. Nothing is required.
					</span>
					<ul id="local-events" class="font-normal">
						<center>(select a Location at top left)</center>
					</ul><!-- populated dynamically -->
				</div>
				<div id="instructions-box" class="instructions-box font-starwars tooltip"><strong>Suggested Usage:</strong>
					<span class="tooltiptext">
					First step is to choose a Location (not Destination) from the dropdown at top left.<br/>
					This populates the details for that location and some random local events which can be optionally chosen.<br/>
					Next, choose a Destination at top right to show details for that location and estimated travel statistics.<br/>
					If you can't read the font, there are buttons underneath the main header. If they don't work, you may have disabled JavaScript.<br/>
					</span>
					<ul>
						<li><em>Select a Current Location</em> (top left) to retrieve local events and customs from BoSS, regional governors, HoloNet, etc.</li>
						<li>Each local event is a <i>possibility</i> - a <i>rumor</i> - to enhance the narrative. <b>Nothing is required.</b> Use what makes sense and prompts a better story.</li>
						<li>During their stay in the system, each PC may, at any time, choose to select <em>up to one local event</em> to <em>activate</em> or <em>negate</em> the event for the duration of their stay.</li>
						<li>A local event, once chosen, is unavailable for further actions.</li>
						<li><span class="local-event-free">Free Events</span> may be activated or negated for the duration of stay <i>at no cost</i>, limited to one per player.</li>
						<li><span class="local-event-destiny-required">Destiny Required Events</span> always require a Destiny Point to activate or negate.</li>
						<li><span class="local-event-destiny-optional">Destiny Optional Events</span> can apply for one transaction only at no cost, or a Destiny Point may be used to create a permanent NPC.</li>
						<li><span class="local-event-destiny-optional">Destiny Optional Event</span>-created permanent NPCs are named and managed by the PC who created them, voiced by the GM, and are always available at this location and able to perform the chosen service at no future cost by any PC.</li>
						<li>The GM may, at their discretion, not allow NPCs or events to be found in locations where it doesn't make sense.</li>
						<li>Upon system arrival, and after the party has chosen whether to select any events initially, the GM may activate or negate up to one <span class="local-event-destiny-required">Destiny Required Event</span> (spending a Destiny point if so), and as many <span class="local-event-free">Free Events</span> at no cost as needed for a good story.</li>
						<li><span class="highlight">Highlighted</span> data indicates to the GM and to the PCs that <span class="font-normal starwars-dice boost">b</span>oosts and <span class="font-normal starwars-dice setback">s</span>etbacks are possible consequences of this local event or location description.
						<li>Wondering what a "hot plook" is? It's the latest food craze sweeping the galaxy. Sometimes people mispronounce it. Seems like every time you're waiting in line for another wet bag of <em><i>h</i></em>ot <em><i>pl</i></em>ook, some shady Game Master sidles up to you and offers you a job, or a mission, or a chance to save the galaxy. Whatever you choose, it will probably be a good story to tell at your funeral.</li>
						<li>Expect Imperial presence to be higher near the Core, and weapons laws to be looser nearer or past the Outer Rim.</li>
						<li>Capital Ships (silhouette 5+) pay substantially higher Starport costs.</li>
						<li>Upon departure, all local events and NPCs not made permanent via Destiny Points are reset.</li>
						<li><em>Select a Destination</em> (top right) to display details and estimated travel statistics to that system. Hyperdrive class impacts this heavily, as does the number and quality of Hyperlanes available at this location.</li>
					</ul>
				</div>
			</td>
		</tr>
	</table>

	<script>

		function updateSilhouette()
		{
			shipSilh = $('#silh').val();

			if (shipSilh > 4) // Commercial/Military size
			{
				$('#silhLabel').addClass("silhouette-5-plus");
			}
			else
			{
				$('#silhLabel').removeClass("silhouette-5-plus");
			}

			updateLocalCustoms();
		}

		$(document).ready(function () {
			switchFontBesh(); // set initial font

			// minimize collapsible sections
			$("#locationDetails").slideUp();
			$("#destinationDetails").slideUp();
			$("#manifest-menu-hidden").slideUp();
			$(".hidden").slideUp();

			// Default input values
			$('#cargo').val(0);
			$('#silh').val(4);
			$('#hyperdrive').val(15);

			populateLocationDropdown();
			populateDestinationDropdown();

			// Location dropdown events
			$("#locationDropdown").on("change", function () {
				$("#locationDetails").slideDown(); // display current location details
				switchFontNormal(); // reset font-family

				const currentLocation = $("#locationDropdown").val();
				currentLoc = locations.find(item => item.Name === currentLocation); // JSON object
				currentRegion = regions.find(region => region.Name === currentLoc.Region); // JSON object
				$('#local-eventsLocation').text(currentLocation);

				updateCurrentDetails();

				updateLocalCustoms();

				updateTravelEstimates();

				updateLocalEvents();
			});

			// Destination dropdown events
			$("#destinationDropdown").on("change", function () {
				$("#destinationDetails").slideDown();
				switchFontNormal(); // reset font-family

				currentDestination = $("#destinationDropdown").val();
				destLoc = locations.find(item => item.Name === currentDestination); // JSON object
				destRegion = regions.find(region => region.Name === destLoc.Region); // JSON object

				updateDestDetails();

				updateTravelEstimates();

				updateDestDetails();
			});

			// On Change event for Ship Silhouette
			document.getElementById("silh").addEventListener("change", updateSilhouette);

			// On Change event for Hyperdrive Class
			document.getElementById("hyperdrive").addEventListener("change", updateTravelEstimates);

			// On Change event for Declared Cargo

			// On Change event for Undeclared Cargo

			// On Change event for Pirate Holonet
			document.getElementById("pirateHolonet").addEventListener("change", togglePirateHolonet);

			// On Change event for dropdown filters

			// General update of everything
			$("input").change(function() {
				populateLocationDropdown();
				populateDestinationDropdown();
			});
		});
	</script>

</body>

</html>
