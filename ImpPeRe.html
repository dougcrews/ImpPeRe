<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Imperial Penal Report</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="ImpPeRe.js"></script>
	<link rel="stylesheet" href="ImpPeRe.css">
</head>

<body>

	<h2>Imperial Penal Report</h2>

	<table border="2" width="100%">
		<tr>
			<td style="vertical-align:top;">
				<div class="form-group">
					<label for="locationDropdown">Location:
						<select id="locationDropdown">
							<option value="">-- Current Location --</option>
						</select>
					</label>
				</div>
				<div id="locationDetails" class="section widthHalf">
					<h3>General Information</h3>
					<p>
						<strong>Region:</strong> <span id="currentRegion">unknown</span>
						<strong>Sector:</strong> <span id="currentSector">unknown</span>
						<strong>System:</strong> <span id="currentSystem">unknown</span>
						<strong>Capital City:</strong> <span id="currentCapital">unknown</span>
						<strong>Starport:</strong> <span id="currentStarport">unknown</span>
						<strong>Map:</strong> <span id="currentMap">unknown</span>
					</p>
					<h3>Atmosphere & Terrain</h3>
					<p>
						<strong>Atmosphere:</strong> <span id="currentAtmosphere">unknown</span>
						<strong>Terrain:</strong> <span id="currentTerrain">unknown</span>
						<strong>Inhabitants:</strong> <span id="currentInhabitants">unknown</span>
						<strong>Climate:</strong> <span id="currentClimate">unknown</span>
						<strong>Gravity:</strong> <span id="currentGravity">unknown</span>
						<strong>URL Link:</strong> <a id="currentURL"
							href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
							target="_blank">unknown</a>
					</p>
					<h3>Current Conditions</h3>
					<p>
						<strong>Climate:</strong> unknown
						<strong>Weather:</strong> unknown
						<strong>Terrain:</strong> unknown
					</p>
				</div>
			</td>
			<td style="vertical-align:top;">
				<div class="form-group">
					<label for="destinationDropdown">Destination:
						<select id="destinationDropdown">
							<option value="">-- Select Destination --</option>
						</select>
					</label>
					<div id="destinationDetails" class="section widthHalf">
					<h3>General Information</h3>
					<p>
						<strong>Region:</strong> <span id="destRegion">unknown</span>
						<strong>Sector:</strong> <span id="destSector">unknown</span>
						<strong>System:</strong> <span id="destSystem">unknown</span>
						<strong>Capital City:</strong> <span id="destCapital">unknown</span>
						<strong>Starport:</strong> <span id="destStarport">unknown</span>
						<strong>Map:</strong> <span id="destMap">unknown</span>
					</p>
					<h3>Atmosphere & Terrain</h3>
					<p>
						<strong>Atmosphere:</strong> <span id="destAtmosphere">unknown</span>
						<strong>Terrain:</strong> <span id="destTerrain">unknown</span>
						<strong>Inhabitants:</strong> <span id="destInhabitants">unknown</span>
						<strong>Climate:</strong> <span id="destClimate">unknown</span>
						<strong>Gravity:</strong> <span id="destGravity">unknown</span>
						<strong>URL Link:</strong> <a id="destURL"
							href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
							target="_blank">unknown</a>
					</p>
				</div>
			</td>
		</tr>
	</table>

	<table border="2" width="100%">
		<tr><!-- Imperial Presence -->
			<td style="vertical-align:middle;">
				<div style="vertical-align:top; display:block; margin:10px; padding:10px; border:5px solid grey; background-color:darkGrey;">
					<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Starports</h4>
					<strong>Landing Fee:</strong> <span id="textFeePortLanding"></span><br/>
					<strong>Berthing Fee (per day):</strong> <span id="textFeePortBerthing"></span><br/>
					<strong>Customs Fee:</strong> <span id="textFeeCustoms"></span><br/>
					<strong>Visitation Fee:</strong> <span id="textFeeVisitation"></span><br/>
					<strong>Smuggling Penalty:</strong> <span id="textFeeSmuggling"></span><br/>
					<strong>Departure Wait:</strong> <span id="textWaitDeparture"></span><br/>
					<strong>Fuel Cells (each):</strong> <span id="textFeeFuelCell"></span><br/>
					<strong>Power (per day):</strong> <span id="textFeePortPower"></span><br/>
					<strong>Consumables (per day):</strong> <span id="textFeeConsumables"></span><br/>
					<strong>Maintenance (per day):</strong> <span id="textFeePortMaintenance"></span><br/>
				</div>
				<div style="vertical-align:top; display:block; margin:10px; padding:10px; border:5px solid grey; background-color:darkGrey;">
					<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Weapon Permits</h4>
					<strong>Small Arms:</strong> <span id="textPermitWeaponSmall"></span><br/>
					<strong>Rifles, Large Melee:</strong> <span id="textPermitWeaponRifle"></span><br/>
					<strong>Heavy Weapons:</strong> <span id="textPermitWeaponHeavy"></span><br/>
					<strong>Concealed Weapons:</strong> <span id="textPermitWeaponConcealed"></span><br/>
					<strong>Light Armor:</strong> <span id="textPermitArmorLight"></span><br/>
					<strong>Restricted/Military:</strong> <span id="textPermitArmorPower"></span><br/>
				</div>
				<div style="vertical-align:top; display:block; margin:10px; padding:10px; border:5px solid grey; background-color:darkGrey;">
					<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Contraband</h4>
					<strong>Spice:</strong> <span id="textLawSpice"></span><br/>
					<strong>Trespassing:</strong> <span id="textLawTrespassing"></span><br/>
					<strong>Poison:</strong> <span id="textLawPoison"></span><br/>
					<strong>Military Gear:</strong> <span id="textLawMilitary"></span><br/>
					<strong>Slicing:</strong> <span id="textLawSlicing"></span><br/>
					<strong>Criticism of the Empire:</strong> <span id="textLawCriticism"></span><br/>
					<strong>Minor Theft:</strong> <span id="textLawTheft"></span><br/>
					<strong>Bribery:</strong> <span id="textLawBribery"></span><br/>
				</div>
				<div style="vertical-align:top; display:block; margin:10px; padding:10px; border:5px solid grey; background-color:darkGrey;">
					<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Local Customs</h4>
					<strong>Speeders:</strong> <span id="textSpeeders"></span><br/>
					<strong>Riding Beasts:</strong> <span id="textRidingBeasts"></span><br/>
					<strong>Slaves:</strong> <span id="textLawSlavery"></span><br/>
					<strong>Droids, Restrained:</strong> <span id="textLawDroidsRestrained"></span><br/>
					<strong>Droids, Unrestrained:</strong> <span id="textLawDroidsFree"></span><br/>
					<strong>Cybernetics Installed:</strong> <span id="textLawCybernetics"></span><br/>
				</div>
				<div style="vertical-align:top; display:block; margin:10px; padding:10px; border:5px solid grey; background-color:darkGrey;">
					<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Pets, Livestock, Mounts</h4>
					<strong>Silhouette 0:</strong> Native Species: <span id="textPetsNative0"></span><br/>
					<strong>Silhouette 1-2:</strong> Native Species: <span id="textPetsNative12"></span><br/>
					<strong>Silhouette 3+:</strong> Native Species: <span id="textPetsNative3"></span><br/>
					<strong>Silhouette 0:</strong> Non-Native Species: <span id="textPetsForeign0"></span><br/>
					<strong>Silhouette 1-2:</strong> Non-Native Species: <span id="textPetsForeign12"></span><br/>
					<strong>Silhouette 3:</strong> Non-Native Species: <span id="textPetsForeign3"></span><br/>
					<strong>Dangerous (any size):</strong> <span id="textPetsDangerous"></span><br/>
				</div>
			</td>
			<td style="vertical-align: top; display: block;">
				<h4 style="text-align:center; margin-top:0px; margin-bottom:5px">Local Conditions</h4>
				<ul>
					<li>ATTENTION, NAVIGATOR: You have arrived safely in the planetary system.</li>
					<li>Local Weather and Terrain: hot, desert</li>
					<li></li>
					<li>ATTENTION, CAPTAIN: Imperial Starbase or Carrier nearby.</li>
					<li>ATTENTION, CAPTAIN:  Imperial Customs is active in the area.</li>
					<li>ATTENTION, CAPTAIN:  Fugitives being sought by Imperial Procurator and/or IOCI forces in the area.</li>
					<li>ATTENTION, CAPTAIN:  Imperial Revenue is active in the area. You may be searched for contraband.</li>
					<li>ATTENTION, CAPTAIN:  Bureau of Ships & Services (BoSS) has a checkpoint nearby. You may be asked for your BoSS Datapad.</li>
					<li>A DISTURBANCE IN THE FORCE: All PCs gain 1 Force Die while in the system, but ONLY DARK SIDE pips may be used for successes.</li>
					<li>I KNOW A GUY: +b to Stealth check(s).</li>
					<li>I KNOW A GUY: +b to Streetwise check(s).</li>
					<li>I KNOW A GUY: +b to Computers check(s).</li>
					<li>I KNOW A GUY: +b to Education check(s).</li>
					<li>I KNOW A GUY: +b to Education check(s).</li>
					<li>I KNOW A GUY: +b to Streetwise check(s).</li>
					<li>I KNOW A GUY: +b to Core Worlds check(s).</li>
					<li>I KNOW A GUY: +b to Core Worlds check(s).</li>
					<li>I KNOW A GUY: +b to Underworld check(s).</li>
					<li>I KNOW A GUY: +b to Computers check(s).</li>
					<li>I KNOW A GUY: +b to Core Worlds check(s).</li>
					<li>I KNOW A GUY: +b to Underworld check(s).</li>
					<li>I KNOW A GUY: +b to Computers check(s).</li>
					<li>ATTENTION, CAPTAIN: Sensors indicate a possible hideout in this system (+s to be detected).</li>
					<li>SURPLUS: -1 Rarity on weapons.</li>
					<li>SURPLUS: -1 Rarity on armor.</li>
					<li>SURPLUS: -1 Rarity on ship components.</li>
					<li>SURPLUS: -1 Rarity on cybernetics.</li>
					<li>LOCAL COLOR: Maintenance crew at work in the area.</li>
					<li>LOCAL COLOR: Spaceport fees halved/doubled.</li>
					<li>RUSH HOUR: Vehicle/Foot traffic higher than normal.</li>
					<li>LOCAL COLOR: Law enforcement has locked down an important location.</li>
					<li>FAVORABLE CONTACTS: +b to Charm check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Coercion check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Computers check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Deception check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Mechanics check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Medicine check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Negotiation check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Streetwise check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Survival check(s).</li>
					<li>FAVORABLE CONTACTS: +b to Vigilance check(s).</li>
					<li>ATTENTION, CAPTAIN: Potential megafauna in the area.</li>
					<li>NEW SHERIFF: Local leadership takes an interest in you.</li>
					<li>SEE 'EM COMING: +b to Piloting vs. megafauna.</li>
					<li>LOOT ALERT: Sensors indicate a debris field nearby.</li>
					<li>LOOT ALERT: Sensors indicate a derelict spaceship nearby.</li>
					<li>LOCAL EXPERT: +b to Xenology regarding local flora and fauna.</li>
					<li>SURPLUS: -1 Rarity on weapons.</li>
					<li>SURPLUS: -1 Rarity on armor.</li>
					<li>SURPLUS: -1 Rarity on survival gear.</li>
					<li>FESTIVAL!: A local event draws crowds.</li>
					<li>POLITICAL STRIFE: Tensions are running high.</li>
					<li>LOCAL WEATHER: Sensors indicate a storm on the horizon.</li>
				</ul>
			</td>
		</tr>
	</table>






















































<!--
	<table class="form-group widthFullscreen" border="2">
		<tr>
			<td>
				<button class="toggleBtn" data-target="#Options">Options</button>
				<button class="toggleBtn" data-target="#ImperialPresence">Imperial Presence</button>
				<button class="toggleBtn" data-target="#LawAndOrder">Law And Order</button>
				<button class="toggleBtn" data-target="#FloraAndFauna">Flora And Fauna</button>
			</td>
		</tr>
		<tr>
			<td>
				<div class="form-group">
					<label for="locationDropdown">Location:
						<select id="locationDropdown">
							<option value="">-- Current Location --</option>
						</select>
					</label>
					<div id="locationDetails" class="section widthHalf">
						<section id="location-general-info">
							<h3>General Information</h3>
							<p>
								<strong>Region:</strong> <span id="currentRegion">unknown</span>
								<strong>Sector:</strong> <span id="currentSector">unknown</span>
								<strong>System:</strong> <span id="currentSystem">unknown</span>
								<strong>Capital City:</strong> <span id="currentCapital">unknown</span>
								<strong>Starport:</strong> <span id="currentStarport">unknown</span>
								<strong>Map:</strong> <span id="currentMap">unknown</span>
							</p>
							<h3>Atmosphere & Terrain</h3>
							<p>
								<strong>Atmosphere:</strong> <span id="currentAtmosphere">unknown</span>
								<strong>Terrain:</strong> <span id="currentTerrain">unknown</span>
								<strong>Inhabitants:</strong> <span id="currentInhabitants">unknown</span>
								<strong>Climate:</strong> <span id="currentClimate">unknown</span>
								<strong>Gravity:</strong> <span id="currentGravity">unknown</span>
								<strong>URL Link:</strong> <a id="currentURL"
									href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
									target="_blank">unknown</a>
							</p>
							<h3>Current Conditions</h3>
							<p>
								<strong>Climate:</strong> unknown
								<strong>Weather:</strong> unknown
								<strong>Terrain:</strong> unknown
							</p>
						</section>
					</div>
				</div>
			</td>
			<td>
				<div class="form-group">
					<label for="destinationDropdown">Destination:
						<select id="destinationDropdown">
							<option value="">-- Select Destination --</option>
						</select>
					</label>
					<div id="destinationDetails" class="section widthHalf">
						<section id="destination-general-info">
							<h2>General Information</h2>
							<p><strong>Region:</strong> <span id="destRegion">unknown</span></p>
							<p><strong>Sector:</strong> <span id="destSector">unknown</span></p>
							<p><strong>System:</strong> <span id="destSystem">unknown</span></p>
							<p><strong>Capital City:</strong> <span id="destCapital">unknown</span></p>
							<p><strong>Map:</strong> <span id="destMap">unknown</span></p>
							<h2>Atmosphere & Terrain</h2>
							<p><strong>Atmosphere:</strong> <span id="destAtmosphere">unknown</span></p>
							<p><strong>Terrain:</strong> <span id="destTerrain">unknown</span></p>
							<p><strong>Inhabitants:</strong> <span id="destInhabitants">unknown</span></p>
							<p><strong>Climate:</strong> <span id="destClimate">unknown</span></p>
							<p><strong>Gravity:</strong> <span id="destGravity">unknown</span></p>
							<p><strong>URL Link:</strong> <a id="destURL"
									href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
									target="_blank">unknown</a></p>
							<h2>Current Conditions</h2>
							<p><strong>Climate:</strong> Arid</p>
							<p><strong>Weather:</strong> Dusty, clear</p>
							<p><strong>Terrain:</strong> Desert</p>
						</section>
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="container widthFull">
					<div id="ImperialPresence" class="section">
						<h3>Imperial Presence</h3>
						<section id="imperial-presence">
							<h2>Imperial Presence</h2>
							<p><strong>Attention Message:</strong> You have arrived safely in the Geonosis system.</p>
							<p><strong>Starports:</strong></p>
							<ul>
								<li><strong>Landing Fee:</strong> <span id="textFeePortLanding"></span></li>
								<li><strong>Berthing Fee (per day):</strong> <span id="textFeePortBerthing"></span></li>
								<li><strong>Customs Fee:</strong> <span id="textFeeCustoms"></span></li>
								<li><strong>Visitation Fee:</strong> <span id="textFeeVisitation"></span></li>
								<li><strong>Smuggling Penalty:</strong> <span id="textFeeSmuggling"></span></li>
								<li><strong>Departure Wait:</strong> <span id="textWaitDeparture"></span></li>
								<li><strong>Fuel Cells (each):</strong> <span id="textFeeFuelCell"></span></li>
								<li><strong>Power (per day):</strong> <span id="textFeePortPower"></span></li>
								<li><strong>Consumables (per day):</strong> <span id="textFeeConsumables"></span></li>
								<li><strong>Maintenance (per day):</strong> <span id="textFeePortMaintenance"></span></li>
							</ul>
							<p><strong>Weapon Permits:</strong></p>
							<ul>
								<li><strong>Small Arms:</strong> <span id="textPermitWeaponSmall"></span></li>
								<li><strong>Rifles, Large Melee:</strong> <span id="textPermitWeaponRifle"></span></li>
								<li><strong>Heavy Weapons:</strong> <span id="textPermitWeaponHeavy"></span></li>
								<li><strong>Concealed Weapons:</strong> <span id="textPermitWeaponConcealed"></span></li>
								<li><strong>Light Armor:</strong> <span id="textPermitArmorLight"></span></li>
								<li><strong>Restricted/Military:</strong> <span id="textPermitArmorPower"></span></li>
							</ul>
							<strong>Violations: Confiscation + 200% fine</strong></p>
							<p>
						</section>
					</div>
				</div>
			</td>
		</tr>
		</tr>
		<tr>
			<td>
				<div id="LawAndOrder" class="section">
					<section id="law-order">
						<h2>Law and Order</h2>
						<p><strong>Attention Message:</strong> Sensors indicate a possible hideout in this system.</p>
						<p><strong>Contraband:</strong></p>
						<ul>
							<li><strong>Spice:</strong> <span id="textLawSpice"></span></li>
							<li><strong>Recreational Drugs:</strong> <span id="textLawDrugs"></span></li>
							<li><strong>Regulated Ores:</strong> <span id="textLawOres"></span></li>
							<li><strong>Trespassing:</strong> <span id="textLawTrespassing"></span></li>
							<li><strong>Poison:</strong> <span id="textLawPoison"></span></li>
							<li><strong>Military Comms:</strong> <span id="textLawMilitary"></span></li>
							<li><strong>Slicing:</strong> <span id="textLawSlicing"></span></li>
						</ul>
						<p><strong>Criticism of the Empire:</strong> <span id="textLawCriticism"></span></p>
						<p><strong>Minor Theft:</strong> <span id="textLawTheft"></span></p>
						<p><strong>Bribery:</strong> <span id="textLawBribery"></span></p>
						<p><strong>Local Customs:</strong></p>
						<ul>
							<li><strong>Slaves:</strong> <span id="textLawSlavery"></span></li>
							<li><strong>Droids, Restrained:</strong> <span id="textLawDroidsRestrained"></span></li>
							<li><strong>Droids, Unrestrained:</strong> <span id="textLawDroidsFree"></span></li>
							<li><strong>Cybernetics Installed:</strong> <span id="textLawCybernetics"></span></li>
						</ul>
					</section>
				</div>
			</td>
		</tr>
		</tr>
		<tr>
			<td>
				<div id="FloraAndFauna" class="section">
					<section id="flora-fauna">
						<h2>Flora and Fauna</h2>
						<p><strong>Pets, Livestock, Mounts:</strong></p>
						<ul>
							<li><strong>Silhouette 0:</strong> Native Species: <span id="textPetsNative0"></span></li>
							<li><strong>Silhouette 1-2:</strong> Native Species: <span id="textPetsNative12"></span></li>
							<li><strong>Silhouette 3+:</strong> Native Species: <span id="textPetsNative3"></span></li>
							<li><strong>Silhouette 0:</strong> Non-Native Species: <span id="textPetsForeign0"></span></li>
							<li><strong>Silhouette 1-2:</strong> Non-Native Species: <span id="textPetsForeign12"></span></li>
							<li><strong>Silhouette 3:</strong> Non-Native Species: <span id="textPetsForeign3"></span></li>
							<li><strong>Dangerous (any size):</strong> <span id="textPetsDangerous"></span></li>
						</ul>
						<p><strong>Speeders:</strong> <span id="textSpeeders"></span></p>
						<p><strong>Riding Beasts:</strong> <span id="textRidingBeasts"></span></p>
					</section>
				</div>
			</td>
		</tr>
	</table>
-->




	<script>
		// Auto-compact sections
//		$("#options").slideUp();
//		$("#ImperialPresence").slideUp();
//		$("#LawAndOrder").slideUp();
//		$("#FloraAndFauna").slideUp();

		// Converts a number to an integer, max 5, min 0.
		function sanitize0to5(val)
		{
			const saneVal = (Number.isInteger(Math.round(val)) ? Math.round(val) : 0);
			const retVal = Math.min(Math.max(saneVal, 0), 5); // integer, 0 to 5 inclusive
			return retVal;
		}

		// Converts a number to an integer, max 5, min -5.
		function sanitizeMinus5to5(val)
		{
			const saneVal = (Number.isInteger(Math.round(val)) ? Math.round(val) : 0);
			const retVal = Math.min(Math.max(saneVal, -5), 5); // integer, -5 to 5 inclusive
			return retVal;
		}

		// Converts a number to an integer, max 9, min 0.
		// (Rarity goes higher as value goes lower)
		function sanitizeRarity(val)
		{
			const saneVal = (Number.isInteger(Math.round(-val)) ? Math.round(val) : 0);
			const retVal = Math.min(Math.max(saneVal, 0), 9); // integer, 0 to 9 inclusive
			return retVal;
		}

		// Converts a number to display value: "XXcr" or "(waived)"
		function creditsOrWaived(val)
		{
			const saneVal = (Number.isInteger(Math.round(val)) ? Math.round(val) : 0);
			if (saneVal === 0)
			{
				return "(waived)";
			}
			else
			{
				return saneVal + "cr";
			}
			return retVal;
		}

		function rarityModFor(json)
		{
			baseRarity = json.Rarity;
			region = json.Region;
			regionRarity = regions.find(item => item.Name === json.Region).Rarity;
			return baseRarity + regionRarity;
		}

		// Converts a number to display value: "Rarity X(R)" or ""
		function rarityText(val)
		{
			retVal = "";
			saneRarity = sanitizeRarity(val);
			if (saneRarity>0)
			{
				retVal += "Rarity " + saneRarity;
			  if (saneRarity>6)
			  {
				  retVal += "(R) ";
			  }
			  retVal += ", ";
			}
			return retVal;
		}

		// Converts a number to display value for weapon/armor permits
		function permitText(val, cost, rarity)
		{
			retVal = "";
			const saneVal = sanitizeMinus5to5(val);
			const saneRar = 6 - val - rarity;
			switch(saneVal)
			{
				case -5: retVal += "Major Felony"; break;
				case -4: retVal += "Felony"; break;
				case -3: retVal += "Misdemeanor"; break;
				case -2: retVal += "Infraction"; break;
				case -1: retVal += "frowned on"; break;
				case 0: retVal += "(waived)"; break;
				case 1: retVal += "Permit (" + rarityText(saneRar) + cost + "cr)"; break;
				case 2: retVal += "Permit (" + rarityText(saneRar) + cost + "cr)"; break;
				case 3: retVal += "Permit (" + rarityText(saneRar) + cost + "cr)"; break;
				case 4: retVal += "no restrictions"; break;
				case 5: retVal += "recommended"; break;
				default: retVal += "ERROR: invalid val in permitText()";
			}

			return retVal;
		}

		// Converts a number to display value for various local crimes
		function legalityOf(val)
		{
			const saneVal = sanitizeMinus5to5(val);
			switch(sanitizeMinus5to5(saneVal))
			{
				case -5: return "Major Felony";
				case -4: return "Felony";
				case -3: return "Misdemeanor";
				case -2: return "Infraction";
				case -1: return "frowned upon";
				case 0: return "tolerated";
				case 1: return "allowed";
				case 2: return "encouraged";
				case 3: return "recommended";
				case 4: return "highly recommended";
				case 5: return "required";
			}
		}

		// converts a number to a starport description
		// "Operational Costs" fan supplement grades them 1 (best) to 5 (worst)
		function starportText(val) {
			switch(sanitize0to5(val))
			{
				case 0: return "(no starport listed)";
				case 1: return "Imperial Class";
				case 2: return "Stellar Class";
				case 3: return "Standard Class";
				case 4: return "Limited Services";
				case 5: return "Landing Field";
			}
			return "ERROR: unknown"; // fallthrough default
		}

		$(document).ready(function () {
			// minimize collapsible sections
			$("#locationDetails").slideUp();
			$("#destinationDetails").slideUp();


			// Populate location dropdown
			const $locationDropdown = $("#locationDropdown");
			$.each(locations, function (index, location) {
				$locationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Populate destination dropdown
			const $destinationDropdown = $("#destinationDropdown");
			$.each(locations, function (index, location) {
				$destinationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Toggle button functionality
			$(".toggleBtn").click(function () {
				const target = $(this).data("target");
				$(target).slideToggle();
			});

			// Location dropdown events
			$("#locationDropdown").on("change", function () {
				$("#locationDetails").slideDown();
				const currentLocation = $("#locationDropdown").val();
				const currentLoc = locations.find(item => item.Name === currentLocation); // JSON object

				// Options calculations & variables
				const shipSilhouette = 4;
				const shipCargoDeclared = 0;

				// Current Location update screen elements
				$('#currentRegion').text(currentLoc.Region);
				$('#currentSector').text(currentLoc.Sector);
				$('#currentSystem').text(currentLoc.System);
				$('#currentCapital').text(currentLoc.CapitalCity);
				$('#currentMap').text(currentLoc.Map);
				$('#currentAtmosphere').text(currentLoc.Atmosphere);
				$('#currentTerrain').text(currentLoc.Terrain);
				$('#currentInhabitants').text(currentLoc.Inhabitants);
				$('#currentClimate').text(currentLoc.Climate);
				$('#currentGravity').text(currentLoc.Gravity);
				$('#currentStarport').text(starportText(currentLoc.starport));
				$('#currentURL').attr('title', currentLoc.Name);
				$('#currentURL').attr('href', currentLoc.URL);

				// Empire Presence calculations
				// https://star-wars-rpg-ffg.fandom.com/wiki/Category:Ship_Operating
				const feePortLanding = sanitize0to5(currentLoc.ImperialPresence);
				const textFeePortLanding = creditsOrWaived(feePortLanding);
				const feePortBerthing = Math.round(feePortLanding * 0.1);
				const textFeePortBerthing = creditsOrWaived(feePortBerthing);
				const feeFuelCell = feePortBerthing; // @FIX see the URL above
				const textFeeFuelCell = creditsOrWaived(Math.max(feeFuelCell, 10));
				const feePortPower = feePortBerthing; // @FIX see the URL above
				const textFeePortPower = creditsOrWaived(Math.max(feePortPower, 10));
				const feeConsumables = feePortBerthing; // @FIX see the URL above
				const textFeeConsumables = creditsOrWaived(Math.max(feeConsumables, 10));
				const feePortMaintenance = feePortBerthing; // @FIX see the URL above
				const textFeePortMaintenance = creditsOrWaived(Math.max(feePortMaintenance, 10));
				const feeCustoms = Math.round(shipCargoDeclared * 0.01); // "waived" if zero
				const textFeeCustoms = creditsOrWaived(Math.max(feeCustoms, 10));
				const feeVisitation = Math.round(feePortBerthing * 0.1); // "waived" if zero
				const textFeeVisitation = creditsOrWaived(Math.max(feeVisitation, 10));
				const feeSmuggling = Math.round(shipCargoDeclared * 0.2); // "no cargo declared" if no cargo; "(minor bribe)" if small
				const textFeeSmuggling = creditsOrWaived(Math.max(feeSmuggling, 10));
				const waitDeparture = Math.round(feePortLanding); // in hours
				const textWaitDeparture = (waitDeparture>24
					? (waitDeparture/24).toFixed(1) + " days"
					: waitDeparture.toFixed(0) + " hours"
					);

				// Empire Presence update screen elements
				$('#textFeePortLanding').text(textFeePortLanding);
				$('#textFeePortBerthing').text(textFeePortBerthing);
				$('#textFeeCustoms').text(textFeeCustoms);
				$('#textFeeVisitation').text(textFeeVisitation);
				$('#textFeeSmuggling').text(textFeeSmuggling);
				$('#textWaitDeparture').text(textWaitDeparture);
				$('#textFeeFuelCell').text(textFeeFuelCell);
				$('#textFeePortPower').text(textFeePortPower);
				$('#textFeeConsumables').text(textFeeConsumables);
				$('#textFeePortMaintenance').text(textFeePortMaintenance);

				const currentRegion = regions.find(region => region.Name === currentLoc.Region);
				const rarityMod = rarityModFor(currentLoc);

/*
Core Worlds (Imp=5+5, W=-1/-2/-3/-4/-2/-3, R=-1)
-5	-2	Small Arms: Treason
-6	-3	Rifles, Large Melee: Treason
-7	-4	Heavy Weapons: Treason
-8	-5	Concealed Weapons: Treason
-6	-3	Light Armor: Treason
-7	-4	Restricted/Military: Treason

Mid Rim (Imp=2, W=3/2/1/0/2/1, R=+1)
0	3	Small Arms: Permit (Rarity 8(R) , 30cr)
-1	2	Rifles, Large Melee: (waived)
-2	1	Heavy Weapons: frowned on
-3	0	Concealed Weapons: Infraction
-1	2	Light Armor: (waived)
-2	1	Restricted/Military: frowned on

Outer Rim (Imp=1, W=4/3/2/1/3/2, R=+2) -Imp +W -R
1	4	Small Arms: Permit (Rarity 1, 10cr)
0	3	Rifles, Large Melee: Permit (Rarity 2, 20cr)
-1	2	Heavy Weapons: Permit (Rarity 3, 30cr)
-2	1	Concealed Weapons: (waived)
0	3	Light Armor: Permit (Rarity 2, 20cr)
-1	2	Restricted/Military: Permit (Rarity 3, 30cr)
*/
				const basePermit = 4 - sanitizeMinus5to5(currentLoc.ImperialPresence + currentRegion.ImperialPresence);

				const permitWeaponSmall = basePermit +	currentLoc.WeaponSmall + currentRegion.WeaponSmall;
				const permitWeaponSmallCost = Math.max(currentLoc.Starport, 1) * (4 - permitWeaponSmall) * 10;
				const textPermitWeaponSmall = permitText(permitWeaponSmall, permitWeaponSmallCost, rarityMod);

				const permitWeaponRifle = basePermit +	currentLoc.WeaponRifle + currentRegion.WeaponRifle;
				const permitWeaponRifleCost = Math.max(currentLoc.Starport, 1) * (4 - permitWeaponRifle) * 10;
				const textPermitWeaponRifle = permitText(permitWeaponRifle, permitWeaponRifleCost, rarityMod);

				const permitWeaponHeavy = basePermit + currentLoc.WeaponHeavy + currentRegion.WeaponHeavy;
				const permitWeaponHeavyCost = Math.max(currentLoc.Starport, 1) * (4 - permitWeaponHeavy) * 10;
				const textPermitWeaponHeavy = permitText(permitWeaponHeavy, permitWeaponHeavyCost, rarityMod);

				const permitArmorLight = basePermit + currentLoc.ArmorLight + currentRegion.ArmorLight;
				const permitArmorLightCost = Math.max(currentLoc.Starport, 1) * (4 - permitArmorLight) * 10;
				const textPermitArmorLight = permitText(permitArmorLight, permitArmorLightCost, rarityMod);

				const permitArmorPower = basePermit + currentLoc.ArmorPower + currentRegion.ArmorPower;
				const permitArmorPowerCost = Math.max(currentLoc.Starport, 1) * (4 - permitArmorPower) * 10;
				const textPermitArmorPower = permitText(permitArmorPower, permitArmorPowerCost, rarityMod);

				const permitWeaponConcealed = permitWeaponSmall - 3;
				const permitWeaponConcealedCost = Math.max(currentLoc.Starport, 1) * (4 - permitWeaponConcealed) * 10;
				const textPermitWeaponConcealed = permitText(permitWeaponConcealed, permitWeaponConcealedCost, rarityMod);

				// Empire Presence update screen elements
				$('#textPermitWeaponSmall').text(textPermitWeaponSmall);
				$('#textPermitWeaponRifle').text(textPermitWeaponRifle);
				$('#textPermitWeaponHeavy').text(textPermitWeaponHeavy);
				$('#textPermitWeaponConcealed').text(textPermitWeaponConcealed);
				$('#textPermitArmorLight').text(textPermitArmorLight);
				$('#textPermitArmorPower').text(textPermitArmorPower);

				// Law & Order calculations
				const baseLaw = 0; // - sanitizeMinus5to5(currentLoc.ImperialPresence + currentRegion.ImperialPresence);

				const lawSpice = baseLaw + currentLoc.Spice + currentRegion.Spice;
				const textLawSpice = legalityOf(lawSpice);

				const lawDrugs = baseLaw + currentLoc.Drugs + currentRegion.Drugs;
				const textLawDrugs = legalityOf(lawDrugs);

				const lawOres = baseLaw + currentLoc.Ores + currentRegion.Ores;
				const textLawOres = legalityOf(lawOres);

				const lawTrespassing = baseLaw + currentLoc.Trespassing + currentRegion.Trespassing;
				const textLawTrespassing = legalityOf(lawTrespassing);

				const lawPoison = baseLaw + currentLoc.Poison + currentRegion.Poison;
				const textLawPoison = legalityOf(lawPoison);

				const lawMilitary = baseLaw + currentLoc.Military + currentRegion.Military;
				const textLawMilitary = legalityOf(lawMilitary);

				const lawSlicing = baseLaw + currentLoc.Slicing + currentRegion.Slicing;
				const textLawSlicing = legalityOf(lawSlicing);

				const lawCriticism = baseLaw + currentLoc.Criticism + currentRegion.Criticism;
				const textLawCriticism = legalityOf(lawCriticism);

				const lawTheft = baseLaw + currentLoc.Theft + currentRegion.Theft;
				const textLawTheft = legalityOf(lawTheft);

				const lawBribery = baseLaw + currentLoc.Bribery + currentRegion.Bribery;
				const textLawBribery = legalityOf(lawBribery);

				const lawSlavery = baseLaw + currentLoc.Slavery + currentRegion.Slavery;
				const textLawSlavery = legalityOf(lawSlavery);

				const lawDroidsRestrained = baseLaw + currentLoc.DroidsRestrained + currentRegion.DroidsRestrained;
				const textLawDroidsRestrained = legalityOf(lawDroidsRestrained);

				const lawDroidsFree = baseLaw + currentLoc.DroidsFree + currentRegion.DroidsFree;
				const textLawDroidsFree = legalityOf(lawDroidsFree);

				const lawCybernetics = baseLaw + currentLoc.Cybernetics + currentRegion.Cybernetics;
				const textLawCybernetics = legalityOf(lawCybernetics);

				// Law & Order update screen elements
				$('#textLawSpice').text(textLawSpice);
				$('#textLawDrugs').text(textLawDrugs);
				$('#textLawOres').text(textLawOres);
				$('#textLawTrespassing').text(textLawTrespassing);
				$('#textLawPoison').text(textLawPoison);
				$('#textLawMilitary').text(textLawMilitary);
				$('#textLawSlicing').text(textLawSlicing);
				$('#textLawCriticism').text(textLawCriticism);
				$('#textLawTheft').text(textLawTheft);
				$('#textLawBribery').text(textLawBribery);
				$('#textLawSlavery').text(textLawSlavery);
				$('#textLawDroidsRestrained').text(textLawDroidsRestrained);
				$('#textLawDroidsFree').text(textLawDroidsFree);
				$('#textLawCybernetics').text(textLawCybernetics);

				// Flora & Fauna calculations
				const basePets = 0; // - sanitizeMinus5to5(currentLoc.ImperialPresence + currentRegion.ImperialPresence);

				const petsNative0 = basePets + currentLoc.Megafauna + currentRegion.Megafauna;
				const textPetsNative0 = legalityOf(petsNative0);

				const petsNative12 = petsNative0 - 1;
				const textPetsNative12 = legalityOf(petsNative12);

				const petsNative3 = petsNative12 - 1;
				const textPetsNative3 = legalityOf(petsNative3);

				const petsForeign0 = petsNative3 - 1;
				const textPetsForeign0 = legalityOf(petsForeign0);

				const petsForeign12 = petsForeign0 - 1;
				const textPetsForeign12 = legalityOf(petsForeign12);

				const petsForeign3 = petsForeign12 - 1;
				const textPetsForeign3 = legalityOf(petsForeign3);

				const petsDangerous = -5;
				const textPetsDangerous = legalityOf(petsDangerous);

				// Law & Order update screen elements
				$('#textPetsNative0').text(textPetsNative0);
				$('#textPetsNative12').text(textPetsNative12);
				$('#textPetsNative3').text(textPetsNative3);
				$('#textPetsForeign0').text(textPetsForeign0);
				$('#textPetsForeign12').text(textPetsForeign12);
				$('#textPetsForeign3').text(textPetsForeign3);
				$('#textPetsDangerous').text(textPetsDangerous);

				const speeders = basePets - currentLoc.Megafauna - currentRegion.Megafauna +
					currentLoc.Vehicles + currentRegion.Vehicles;
				const textSpeeders = legalityOf(speeders);

				const ridingBeasts = basePets + currentLoc.Megafauna + currentRegion.Megafauna +
					currentLoc.RidingBeasts + currentRegion.RidingBeasts;
				const textRidingBeasts = legalityOf(ridingBeasts);

				$('#textSpeeders').text(textSpeeders);
				$('#textRidingBeasts').text(textRidingBeasts);
			});

			// Destination dropdown events
			$("#destinationDropdown").on("change", function () {
				$("#destinationDetails").slideDown();
				const currentDestination = $("#destinationDropdown").val();
				const destLoc = locations.find(item => item.Name === currentDestination); // JSON object

				$('#destRegion').text(destLoc.Region);
				$('#destSector').text(destLoc.Sector);
				$('#destSystem').text(destLoc.System);
				$('#destCapital').text(destLoc.CapitalCity);
				$('#destMap').text(destLoc.Map);
				$('#destAtmosphere').text(destLoc.Atmosphere);
				$('#destTerrain').text(destLoc.Terrain);
				$('#destInhabitants').text(destLoc.Inhabitants);
				$('#destClimate').text(destLoc.Climate);
				$('#destGravity').text(destLoc.Gravity);
				$('#destURL').attr('title', destLoc.Name);
				$('#destURL').attr('href', destLoc.URL);
			});

		});
	</script>

</body>

</html>
