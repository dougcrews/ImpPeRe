<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Imperial Penal Report</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="ImpPeRe.js"></script>
	<script src="locations.js"></script>
	<script src="regions.js"></script>
	<script src="events.js"></script>
	<script src="hyperspace.js"></script>
	<link rel="stylesheet" href="ImpPeRe.css">
</head>

<body>

	<h2>Imperial Penal Report</h2>

	<table border="2" width="100%">
		<tr>
			<td class="alignTop nowrap">
				<div class="form-group" style="float: left;">
					<label for="locationDropdown">Location:
						<select id="locationDropdown">
							<option value="">-- Current Location --</option>
						</select>
					</label>
				</div>
				<div style="float: right;">
					<a id="currentURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">unknown</a>
				</div>
			</td>
			<td class="alignTop nowrap">
				<div class="form-group" style="float: left;">
					<label for="destinationDropdown">Destination:
						<select id="destinationDropdown">
							<option value="">-- Select Destination --</option>
						</select>
					</label>
				</div>
				<div style="float: right;">
					<a id="destURL" href="https://starwars.fandom.com/wiki/Planet/Legends" target="_blank">unknown</a>
				</div>
			</td>
		</tr>
		<tr>
			<td class="alignTop" style="colSpan: 2;">
				<div id="locationDetails" class="section widthHalf">
					<ul>
						<li class="locationDetailsItem">
							<strong>Region:</strong> <a id="currentRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="currentRegion">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Sector:</strong> <span id="currentSector">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>System:</strong> <span id="currentSystem">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Capital City:</strong> <span id="currentCapital">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Starport:</strong> <span id="currentStarport">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Map:</strong> <span id="currentMap">unknown</span><br/>
						</li>
						<li class="locationDetailsItem">
							<strong>Hyperspace Lanes:</strong> <pre id="currentHyperspaceLanes">unknown</pre>
						</li>
					</ul>
					<h3>Atmosphere & Terrain</h3>
					<ul>
						<li class="locationDetailsItem">
							<label for="currentAtmosphere" id="currentAtmosphereLabel">Atmosphere:</strong> <span id="currentAtmosphere">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Terrain:</strong> <span id="currentTerrain">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Inhabitants:</strong> <span id="currentInhabitants">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Climate:</strong> <span id="currentClimate">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Gravity:</strong> <span id="currentGravity">unknown</span>
						</li>
					</ul>
					<h3>Current Conditions</h3>
					<p>
						<strong>Climate:</strong> unknown
						<strong>Weather:</strong> unknown
						<strong>Terrain:</strong> unknown
					</p>
				</div>
			</td>
			<td class="alignTop">
				<div id="destinationDetails" class="section widthHalf">
					<ul>
						<li class="locationDetailsItem">
							<strong>Region:</strong> <a id="destRegionURL"
								href="https://starwars.fandom.com/wiki/Unknown_Regions/Legends"
								target="_blank"><span id="destRegion">unknown</span></a>
						</li>
						<li class="locationDetailsItem">
							<strong>Sector:</strong> <span id="destSector">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>System:</strong> <span id="destSystem">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Capital City:</strong> <span id="destCapital">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Starport:</strong> <span id="destStarport">unknown</span>
						</li>
						<li class="locationDetailsItem">
							<strong>Map:</strong> <span id="destMap">unknown</span><br/>
						</li>
						<li class="locationDetailsItem">
							<strong>Hyperspace Lanes:</strong> <pre id="destHyperspaceLanes">unknown</pre>
						</li>
					</ul>
					<h3>Atmosphere & Terrain</h3>
					<ul>
						<li class="locationDetailsItem">
							<label for="destAtmosphere" id="destAtmosphereLabel">Atmosphere:</strong> <span id="destAtmosphere">unknown</span>
						</li>
						<li class="locationDetailsItem">
						<strong>Terrain:</strong> <span id="destTerrain">unknown</span>
						</li>
						<li class="locationDetailsItem">
						<strong>Inhabitants:</strong> <span id="destInhabitants">unknown</span>
						</li>
						<li class="locationDetailsItem">
						<strong>Climate:</strong> <span id="destClimate">unknown</span>
						</li>
						<li class="locationDetailsItem">
						<strong>Gravity:</strong> <span id="destGravity">unknown</span>
						</li>
					</ul>
					<h3>Hyperspace Travel</h3>
					<strong>Estimated Travel Time</strong> (hyperroute factor <span id="hyperrouteFactor">1.0</span>, Class <span id="ettHyperdriveClass">?</span>): <span id="estHyperspaceTime">calculating...</span><br/>
					reference (no hyperroutes, Class 1): <span id="baseHyperspaceTime">calculating...</span><br/>
				</div>
			</td>
		</tr>
	</table>
	<table border="2" width="100%">
		<tr><!-- Ship, Crew, and Conditions options -->
			<td>
				<p class="nowrap">
					<ul>
						<li class="manifestItem">
							<h3>Ship Manifest</h3>
						</li>
						<li class="manifestItem">
							<label for="silh" id="silhLabel">Silhouette: <input type="number" id="silh" max="10" maxlength="2" min="0" defaultValue="4"><span id="silh5plus"></span></input></label>
						</li>
						<li class="manifestItem">
							<label for="hyperdrive">
								Hyperdrive: Class <input type="number" id="hyperdrive" max="20" maxlength="2" min="1" defaultValue="15"></input>
							</label>
						<li class="manifestItem">
							<label for="cargo">Cargo Declared: <input type="number" id="cargo" min="0" defaultValue="0"></input>cr</label>
						</li>
						</li>
					</ul>
				</p>
			</td>
		</tr>
	</table>

	<table border="2" width="100%">
		<tr><!-- Imperial Presence -->
			<td class="alignMiddle">
				<div class="localCustomsBox">
					<h4 class="localCustomsBoxHeader">Starports</h4>
					<strong>Landing Fee:</strong> <span id="textFeePortLanding"></span><br/>
					<strong>Berthing Fee (per day):</strong> <span id="textFeePortBerthing"></span><br/>
					<strong>Customs Fee:</strong> <span id="textFeeCustoms"></span><br/>
					<strong>Visitation Fee:</strong> <span id="textFeeVisitation"></span><br/>
					<strong>Smuggling Penalty:</strong> <span id="textFeeSmuggling">Confiscation + fine</span><br/>
					<strong>Departure Wait:</strong> <span id="textWaitDeparture"></span><br/>
				</div>
				<div class="localCustomsBox">
					<h4 class="localCustomsBoxHeader">Weapon Permits</h4>
					<strong>Concealed Weapons:</strong> <span id="textPermitWeaponConcealed"></span><br/>
					<strong>Small Arms:</strong> <span id="textPermitWeaponSmall"></span><br/>
					<strong>Rifles, Large Melee:</strong> <span id="textPermitWeaponRifle"></span><br/>
					<strong>Heavy Weapons:</strong> <span id="textPermitWeaponHeavy"></span><br/>
					<strong>Light Armor:</strong> <span id="textPermitArmorLight"></span><br/>
					<strong>Restricted/Military:</strong> <span id="textPermitArmorPower"></span><br/>
					<center><strong>Violations:</strong> Confiscation + fine<br/></center>
				</div>
				<div class="localCustomsBox">
					<h4 class="localCustomsBoxHeader">Contraband</h4>
					<strong>Spice:</strong> <span id="textLawSpice"></span><br/>
					<strong>Trespassing:</strong> <span id="textLawTrespassing"></span><br/>
					<strong>Military Gear:</strong> <span id="textLawMilitary"></span><br/>
					<strong>Slicing:</strong> <span id="textLawSlicing"></span><br/>
					<strong>Criticism of the Empire:</strong> <span id="textLawCriticism"></span><br/>
					<strong>Minor Theft:</strong> <span id="textLawTheft"></span><br/>
					<strong>Bribery:</strong> <span id="textLawBribery"></span><br/>
				</div>
			</td>
			<td class="localEvents">
				<h4 class="localCustomsBoxHeader">Local Events</h4>
				<ul id="localEvents"></ul><!-- populated dynamicall -->
				<div class="localCustomsBox"><strong>Suggested Usage:</strong>
				<ul>
					<li>Select a Location to retrieve local events and customs from BoSS, regional governors, HoloNet, etc.</li>
					<li>Each local event is a <i>possibility</i>, a <i>rumor</i>, to enhance the narrative. <b>Nothing is required.</b> Use what makes sense and prompts a better story.</li>
					<li>During their stay in the system, each PC may choose to select <em>up to one local event</em> to <em>activate</em> or <em>negate</em> the event for the duration of their stay.</li>
					<li>A local event, once chosen, is unavailable for further actions.</li>
					<li><span class="localEventFree">Free Events</span> may be activated or negated for the duration of stay <i>at no cost</i>, limited to one per player.</li>
					<li><span class="localEventDestinyRequired">Destiny Required Events</span> always require a Destiny Point to activate or negate.</li>
					<li><span class="localEventDestinyOptional">Destiny Optional Events</span> can apply for one transaction only at no cost, or a Destiny Point may be used to create a permanent NPC.</li>
					<li><span class="localEventDestinyOptional">Destiny Optional Events</span> permanent NPCs are named and managed by the PC who created them, voiced by the GM, and are always available at this spot and able to perform the chosen service at no future cost by any PC.</li>
					<li>The GM may, at their discretion, not allow NPCs to be found in locations where it doesn't make sense.</li>
					<li>Upon system arrival, and after the party has chosen whether to select any events initially, the GM may spend a Destiny Point on up to one <span class="localEventDestinyRequired">Destiny Required Event</span> to activate or negate, and as many <span class="localEventFree">Free Events</span> as creates a good story.</li>
					<li>Expect Imperial presence to be higher near the Core, and weapons laws to be looser nearer or past the Outer Rim.</li>
					<li>Capital Ships (silhouette 5+) pay substantially higher Starport costs.</li>
					<li>Upon departure, all local events and NPCs not made permanent via Destiny Points are reset.</li>
					<li>Select a Destination to display details and estimated travel statistics to that system. Hyperdrive class impacts this heavily, as does the number and quality of Hyperspace Lanes available at this location.</li>
				</ul>
			</td>
		</tr>
	</table>

	<script>

function updateSilhouette()
{
	shipSilh = $('#silh').val();

	if (shipSilh > 4) // Commercial/Military size
	{
		$('#silhLabel').addClass("silhouette5plus");
	}
	else
	{
		$('#silhLabel').removeClass("silhouette5plus");
	}

	updateLocalCustoms();
}

		$(document).ready(function () {
			// minimize collapsible sections
			$("#locationDetails").slideUp();
			$("#destinationDetails").slideUp();

			// Default input values
			$('#cargo').val(0);
			$('#silh').val(4);
			$('#hyperdrive').val(15);

			// Populate location dropdown
			const $locationDropdown = $("#locationDropdown");
			$.each(locations, function (index, location) {
				$locationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Populate destination dropdown
			const $destinationDropdown = $("#destinationDropdown");
			$.each(locations, function (index, location) {
				$destinationDropdown.append(
					$("<option>", { value: location.Name, text: location.Name })
				);
			});

			// Toggle button functionality
			$(".toggleBtn").click(function () {
				const target = $(this).data("target");
				$(target).slideToggle();
			});

			// Location dropdown events
			$("#locationDropdown").on("change", function () {
				$("#locationDetails").slideDown(); // display current location details
				const currentLocation = $("#locationDropdown").val();
				currentLoc = locations.find(item => item.Name === currentLocation); // JSON object
				currentRegion = regions.find(region => region.Name === currentLoc.Region); // JSON object

				updateCurrentDetails();

				updateLocalCustoms();

				updateTravelEstimates();

				updateLocalEvents();
			});

			// Destination dropdown events
			$("#destinationDropdown").on("change", function () {
				$("#destinationDetails").slideDown();
				currentDestination = $("#destinationDropdown").val();
				destLoc = locations.find(item => item.Name === currentDestination); // JSON object
				destRegion = regions.find(region => region.Name === destLoc.Region); // JSON object

				updateDestDetails();

				updateTravelEstimates();

				updateDestDetails();
			});

			// On Change event for Ship Silhouette
			document.getElementById('silh').addEventListener("change", updateSilhouette);

			// On Change event for Hyperdrive Class
			document.getElementById('hyperdrive').addEventListener("change", updateTravelEstimates);
		});
	</script>

</body>

</html>
